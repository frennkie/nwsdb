{% extends "base.html" %}
{% block title %}Scan{% endblock %}
{% block body %}
<!--Body content-->
    <form method="POST" action="/nmap/tasks/" accept-charset="utf-8">
    {% csrf_token %}


    <fieldset>
        <div >
            <legend>Online nmap scanner</legend>

                <div class="col-sm-6">
                    <label for="input_target" class="control-label">Target</label>
                </div>
                <div class="col-sm-6">
                    <input id="input_target" name="targets" type="text" placeholder="127.0.0.1">
                </div>

                <span class="col-sm-12 help-block">specify the ip, subnet or domain you want to target</span>

                <div class="col-sm-6">
                    <label for="input_comment" class="control-label">Comment</label>
                </div>
                <div class="col-sm-6">
                   <input id="input_comment" name="comment" type="text" placeholder="Optional: Scan comment">
                </div>

                <div class="col-sm-12">
                    &nbsp;
                </div>

                <div class="col-sm-6">
                    <label for="noping" >Do not ping target(s)</label>
                </div>
                <div class="col-sm-6">
                    <input id="noping" name="noping" type="checkbox" value="noping" >
                </div>

                <div class="col-sm-12">
                    &nbsp;
                </div>

                <div class="col-sm-6">
                    <label class="checkbox">
                        Enable banner grabbing
                    </label>
                </div>
                <div class="col-sm-6">
                        <input type="checkbox" name="banner" value="banner_detection">
                </div>

                <div class="col-sm-12">
                    &nbsp;
                </div>

                <div class="col-sm-6">
                    <label for="orgunit">Assign to OrgUnit</label>
                </div>

                <div class="col-sm-3">
                    <select id="orgunit" name="orgunit" class="form-control">
                        {% if orgunits %}
                            {% for orgunit in orgunits %}
                                {% if forloop.counter == 1 %}
                                    <option value="{{ orgunit.name }}" selected>{{ orgunit.name }}</option>
                                {% else %}
                                    <option value="{{ orgunit.name }}">{{ orgunit.name }}</option>
                                {% endif %}

                            {% endfor %}
                        {% else %}
                            <option value="no_org">No Org</option>
                        {% endif %}
                    </select>
                </div>
                <div class="col-sm-3">
                    &nbsp;
                </div>

                <div class="col-sm-12">
                    <hr>
                <div>

            <div class="col-sm-12">
                <div class="accordion" id="accordion2">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#nmapOptions">
                            More options
                            </a>
                        </div>
                        <div id="nmapOptions" class="accordion-body collapse">
                            <div class="accordion-inner">
                                <label>Scan techniques:</label>
                                <select name="scantype">
                                    <option id="1" value="1">Connect Scan</option>
                                    <option id="2" value="2">Syn Scan</option>
                                    <option id="3" value="3">Ack Scan</option>
                                    <option id="4" value="4">Window Scan</option>
                                    <option id="5" value="5">Maimon Scan</option>
                                    <option id="6" value="6">Null Scan</option>
                                    <option id="7" value="7">Fin Scan</option>
                                    <option id="8" value="8">Xmas Scan</option>
                                    <option id="9" value="9">UDP Scan</option>
                                </select>
                                <label>Ports specification:</label><input type="text" name="ports" placeholder="22-1024">
                                <span class="help-block">Ex: "22" or "1-65535" or "U:53,111,137,T:21-25,80,139,8080,S:9"</span>
                                <label class="checkbox"><input type="checkbox" name="os" value="os_detection">
                                Enable OS detection
                                </label>
                                <label class="checkbox"><input type="checkbox" name="run_now" value="run_now" checked disabled>
                                Run now
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

            <button type="submit" class="btn btn-primary">Scan</button>
        </div>
    </fieldset>
    </form>
{% endblock %}
